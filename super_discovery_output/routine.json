{
  "name": "amtrak_train_search_one_way",
  "description": "Search for one-way Amtrak trains between two stations on a given date, returning schedules and pricing.",
  "operations": [
    {
      "type": "navigate",
      "url": "https://www.amtrak.com/",
      "sleep_after_navigation_seconds": 3.0
    },
    {
      "type": "sleep",
      "timeout_seconds": 2.0
    },
    {
      "type": "fetch",
      "endpoint": {
        "url": "https://www.amtrak.com/services/MapDataService/AutoCompleterArcgis/getResponseList?searchTerm=\"{{origin}}\"",
        "description": "Fetch origin station autocomplete suggestions based on the origin search term.",
        "method": "GET",
        "headers": {
          "Accept": "application/json, text/plain, */*"
        },
        "body": {},
        "credentials": "include"
      },
      "session_storage_key": "origin_stations"
    },
    {
      "type": "fetch",
      "endpoint": {
        "url": "https://www.amtrak.com/services/MapDataService/AutoCompleterArcgis/getResponseList?searchTerm=\"{{destination}}\"",
        "description": "Fetch destination station autocomplete suggestions based on the destination search term.",
        "method": "GET",
        "headers": {
          "Accept": "application/json, text/plain, */*"
        },
        "body": {},
        "credentials": "include"
      },
      "session_storage_key": "dest_stations"
    },
    {
      "type": "sleep",
      "timeout_seconds": 1.0
    },
    {
      "type": "fetch",
      "endpoint": {
        "url": "https://www.amtrak.com/dotcom/journey-solution-option",
        "description": "Search for one-way journey options and pricing between the resolved origin and destination stations on the given date.",
        "method": "POST",
        "headers": {
          "Content-Type": "application/json",
          "Accept": "application/json, text/plain, */*",
          "x-amtrak-trace-id": "{{sessionStorage:ibsession.sessionid}}"
        },
        "body": {
          "journeyRequest": {
            "fare": {
              "pricingUnit": "DOLLARS"
            },
            "type": "OW",
            "journeyLegRequests": [
              {
                "origin": {
                  "code": "{{sessionStorage:origin_stations.autoCompleterResponse.autoCompleteList.0.stationCode}}",
                  "schedule": {
                    "departureDateTime": "\"{{departureDate}}\"T00:00:00"
                  }
                },
                "destination": {
                  "code": "{{sessionStorage:dest_stations.autoCompleterResponse.autoCompleteList.0.stationCode}}"
                }
              }
            ]
          }
        },
        "credentials": "include"
      },
      "session_storage_key": "search_results"
    },
    {
      "type": "return",
      "session_storage_key": "search_results"
    }
  ],
  "incognito": true,
  "parameters": [
    {
      "name": "origin",
      "type": "string",
      "required": true,
      "description": "Origin city or station search term (e.g., city name or station code) used for autocomplete lookup.",
      "default": null,
      "examples": [],
      "min_length": null,
      "max_length": null,
      "min_value": null,
      "max_value": null,
      "pattern": null,
      "enum_values": null,
      "format": null,
      "observed_value": null
    },
    {
      "name": "destination",
      "type": "string",
      "required": true,
      "description": "Destination city or station search term (e.g., city name or station search term) used for autocomplete lookup.",
      "default": null,
      "examples": [],
      "min_length": null,
      "max_length": null,
      "min_value": null,
      "max_value": null,
      "pattern": null,
      "enum_values": null,
      "format": null,
      "observed_value": null
    },
    {
      "name": "departureDate",
      "type": "string",
      "required": true,
      "description": "Departure date in YYYY-MM-DD format.",
      "default": null,
      "examples": [],
      "min_length": null,
      "max_length": null,
      "min_value": null,
      "max_value": null,
      "pattern": null,
      "enum_values": null,
      "format": null,
      "observed_value": null
    }
  ]
}